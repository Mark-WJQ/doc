#### 读写分离
1. 引入新的复杂度
    * 主从延迟
        - 写操作后的读操作，指定发给主库
        - 读从失败后再读主
        - 关键业务读写全部走主机，非关键业务主从分离
    * 分配机制，将读写分离后，访问不同数据库服务器
        - 程序代码封装
        - 中间件封装
#### 分库分表
1. 读写分离分散了数据库的读写压力，并没有分散数据库的存储压力，当数据量达到千万甚至上亿条时，单台数据库的存储能力会成为系统的瓶颈 
    * 数据量太大读写性能会下降，即使有索引，索引也会变大，性能同样会下降
    * 数据文件会变得很大，数据库备份和恢复会需要很长时间
    * 数据文件越大极端情况下丢失数据的风险越高
2. 业务分库  
    ***业务分库是指将数据按照业务模块分散到不同的数据库服务器中。***  
    * 存在的主要问题
        - join 操作问题
        - 事务问题
        - 成本问题
            - 会根据业务划分数量增长，还有备库服务器
3. 分表
**单表的数据量随着业务的发展会达到瓶颈**  
    1. 垂直分表
        - 将一个表垂直拆分，将不同的业务字段拆到多个表中
        - 主要的复杂度是：查询是需要分开多次查询
    2. 水平分表
        - 水平分表适合表行数特别大的表，水平分表后，虽然物理上数据在多个库表中，但是某些业务逻辑上还是会将这些表按照一个表来处理，如排序、计数等
        - 水平分表的复杂度：查找数据时需要增加路由算法
            - 范围路由
                * 选取有序的数据列（eg：整形、时间戳），作为路由条件，不同分段分散到不同的数据库表中。
                * 复杂度主要体现在范围大小的选取上，范围太小，分表太多，范围太大，表太大，单表可能还有性能问题
                * 优点是：能够平滑扩充新表
                * 缺点是：数据表分布不均匀，每一个分布范围数据量不均匀
            - hash路由
                * 选取某个列或某几个列组合求hash值，然后根据hash结果分散到不同数据库表中。
                * 复杂点：初始表数量的选取上
                * 优点： 数据分布均匀
                * 缺点：扩充新表麻烦，需要对所有数据进行重新hash，参考hashMap 可以减少重新hash的数据量
            - 配置路由
                * 使用路由表，用一张独立的表来记录路由信息
                * 优点：配置路由表设计简单，使用灵活，扩充新表的时候这需要迁移指定数据，然后修改路由信息即可
                * 缺点：需要多访问一次路由表，路由表可能成为性能瓶颈，需要分库分表，套娃
4. 实现方法
    * 代码封装
    * 中间件封装
    
