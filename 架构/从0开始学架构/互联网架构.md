1. 复杂性、用户规模
2. 存储层
    * sql
    * noSql（not only sql）,关系型数据库的补充，结构化存储
    * 小文件存储（头像、评论等）：HBase、Hadoop、Hypertable、FastDFS等都可以作为小文件存储的底层平台
    * 大文件存储：Hadoop、HBase、Storm、Hive
3. 开发层
    * 开发框架
    * web服务器
    * 容器
4. 服务层
    * 配置中心
    * 服务中心（服务发现、调用）
        - 服务名字系统（service name system）
        - 服务总线系统
    * 消息队列
5. 网络层
    * 负载均衡
        - DNS
            * 地理级别均衡
            * DNS 缓存时间较长，即使业务机器下线后，如果缓存没更新，也会访问
            * DNS 不够灵活。不能感知后台服务器的状态，只能根据配置的策略进行负载均衡。
        - HTTP-DNS
            * 使用http协议实现一个私有的DNS系统，主要应用在通过App提供服务的业务上
            * 灵活、可控、及时
            * 开发成本高，没有通用解决方案；有入侵性，需要APP基于HTTP-DNS改造
        - Nginx,LVS,F5
            * Nginx 是基于软件的7层负载均衡，LVS是内核的四层负载均衡，F5是4层的负载均衡
    * CDN
        - 为了解决用户访问时“最后一公里”效应，本质是一种以空间换时间的策略，即将内容缓存在离用户最近的地方，用户访问的是缓存内容，而不是站点实时内容
    * 多机房-主要目标是灾备
        - 同城多机房
        - 跨城多机房
        - 跨国多机房
    * 多中心
        - 多中心必须一多机房为前提
        - 多中心要求每个中心都可以提供服务，并且业务能够在多中心之间自动切换，故障后不需要或需要少量人工干预即可恢复
        - 多中心的设计难点：数据一致性与数据事务性如何保证，这些与业务密切相关，目前没有通用的解决方案
6. 用户层
    * 用户管理
        - 单点登录:cookie,jsonp,token,CAS
        - 授权登录:OAuth 2.0
    * 消息推送：短信、邮件、站内信、APP推送
    * 存储云、图片云
        - 用户上传文件的特点
            + 数据量大：用户基数大，用户上传行为频繁
            + 文件体积小
            + 访问有时效性
7. 业务层
    * 拆：复杂度越来越高的一个主要原因就是系统越来越庞大，业务越来越多。化整为零，分而治之，将整体复杂性分散到多个子业务或子系统里面去
    * 合：随着业务的复杂度提升，拆封的系统越来越多，已经没人能够说清楚业务的调用流程了，除了问题排查也特别复杂。按照“高内聚，低耦合”的原则，将职责关联比较强的子系统合成一个虚拟业务域，然后通过网关对外统一呈现
    ![](img/%E4%B8%9A%E5%8A%A1%E5%9F%9F.webp)
8. 平台技术
    * 运维平台：
        + 核心职责分为四大块
            - 配置:主要负责资源的管理。例如：机器管理、IP地址管理、虚拟机管理等
            - 部署：主要负责将系统发布到线上。例如：包管理、灰度发布管理、回滚等
            - 监控：主要负责收集系统上线运行后的相关数据并进行监控，以便及时发现问题
            - 应急：主要负责系统出故障后处理。eg:停止程序、下线故障机器、切换IP等
        + 设计要素：四化
            - 标准化：需要制定运维标准，规范配置管理、部署流程、监控指标、应急能力等，各系统按照运维标准来实现。标准化是运维平台的基础
            - 平台化：在运维标准化的基础上，将运维的相关操作集成到运维平台上，通过运维平台来完成运维工作
                + 将运维标准固化到平台中，无需运维人员死记硬背
                + 平台提供简单方便的操作，相比之下手动操作低效且容易出错
                + 运维平台是可复用的
            - 自动化
                + 传统手工运维的方式效率低下的的一个重要原因是要执行大量重复的操作，运维平台可以将这些重复操作固化下来，由系统自动完成
                + 运维平台可以自动实时收集数据并进行初步分析，当发现异常情况是自动报警，无需运维盯着
            - 可视化
                + 可视化的原理跟汽车仪表盘类似，将数据转换成视图，并用颜色或图形等直观的视觉效果来展示，人在看到后可以立马关联
                + 能够直观的看到数据的相关属性
                + 能够将数据含义展示出来
                + 能够将关联数据整合在一起
    * 测试平台
        + 核心职责就是测试，单测、集成测试、接口测试、性能测试等，都可以在平台完成
        + 测试平台的核心目的是提升测试效率，从而提升产品质量，其设计关键就是自动化
        ![](img/%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0%E6%9E%B6%E6%9E%84%E5%9B%BE.webp)
        + 用例管理：测试自动化的主要手段就是通过脚本或者代码来进行测试。为了能够重复执行这些测试用例，测试平台需要将用例管理起来，管理的维度包括业务、系统、测试类型、用例代码
        + 资源管理：测试用例要放到具体的运行环境中才能真正执行，运行环境包括硬件、软件、业务系统
        + 任务管理：将测试用例分配到具体的资源上执行，跟踪任务的执行情况。任务管理是测试平台设计的核心，他将测试平台各个部分串联起来从而完成自动化测试
        + 数据管理：测试任务执行完成后，需要记录各种各样的数据（eg:执行时间、执行结果、用例执行期间的CPU，内存占用情况等）
            - 展现当前用例的执行情况
            - 作为历史数据，方便后续测试与历史数据对比，从而发现明显的变化趋势
            - 作为大数据的一部分，可以基于测试的任务数据进行一些数据挖掘。eg:某个业务一年执行了10000个用例测试，另一个业务执行了1000个，两个业务规模和复杂度度差不多，为何差异这么大？
    * 数据平台
        + 核心职责主要包括三部分：数据管理、数据分析和数据应用
        ![](img/%E6%95%B0%E6%8D%AE%E5%BA%94%E7%94%A8.webp)
        + 数据管理
            - 数据采集
            -数据存储
            - 数据访问
            - 数据安全
        + 数据分析
            - 数据统计
            - 数据挖掘
            - 机器学习
            - 深度学习
    * 管理平台
        + 核心职责是权限管理，业务系统、中间件系统、平台系统都需要进行管理，每个都实现成本大、效率低，需要有一个统一的管理平台来管理所有的系统权限
        + 权限管理主要分为两部分：身份认证、权限控制

    
        

